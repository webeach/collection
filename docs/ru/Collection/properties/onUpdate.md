# `onUpdate`

## Описание

Свойство `onUpdate` позволяет подписаться на обновления коллекции.

При изменении коллекции (добавлении, удалении, патчинге, очистке и т.д.) будет вызываться функция, установленная в `onUpdate`, с событием `CollectionUpdateEvent`.

---

## Синтаксис

```ts
collection.onUpdate = (event) => {
  // обработка события
};
```

- **event** — экземпляр `CollectionUpdateEvent`, содержащий актуальный список элементов в коллекции в момент события.

---

## Поведение

- `onUpdate` срабатывает только после успешной операции изменения коллекции.
- Если событие обновления было остановлено через `stopImmediatePropagation()`, то слушатели, добавленные через `addEventListener('update')`, не будут вызваны, но `onUpdate` всё равно сработает.
- Можно заменить текущий обработчик, переписав `onUpdate`.
- Чтобы удалить обработчик, достаточно установить `collection.onUpdate = null`.

---

## Примеры

### Простая подписка на обновления

```ts
collection.onUpdate = (event) => {
  console.log("Коллекция обновлена. Элементов:", event.detail.length);
};
```

### Проверка содержимого событий

```ts
collection.onUpdate = (event) => {
  for (const item of event.detail) {
    console.log("Элемент в коллекции:", item);
  }
};
```

### Остановка дальнейшего распространения события

```ts
collection.onUpdate = (event) => {
  event.stopImmediatePropagation();
  console.log("Обновление обработано только здесь");
};
```
